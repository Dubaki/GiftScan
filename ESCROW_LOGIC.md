# Escrow Logic: MVP Flows

## Сценарий А: P2P Продажа (Sell)
*Пользователь хочет продать подарок за фиксированную сумму.*

1. **Initiation:** Продавец выбирает свой Подарок (из инвентаря) и указывает цену (например, 100 USDT).
2. **Deposit:** Продавец отправляет Подарок боту.
3. **Publication:** Сделка получает статус `WAITING_PAYMENT`. Генерируется ссылка для Покупателя.
4. **Payment:** Покупатель переходит по ссылке, видит лот и отправляет 100 USDT на кошелек бота.
5. **Finalization:** Бот видит поступление денег -> Отправляет Подарок покупателю -> Отправляет USDT продавцу (минус комиссия).

## Сценарий Б: Обмен (Swap 1:1)
*Пользователь хочет поменять "Мишку" на "Торт".*

1. **Initiation:** Инициатор выбирает свой Подарок (Offer) и указывает, какой Подарок хочет получить (Target Gift ID/Slug).
2. **Deposit A:** Инициатор отправляет свой Подарок боту.
3. **Matching:** Второй пользователь соглашается на сделку.
4. **Deposit B:** Второй пользователь отправляет свой Подарок боту.
5. **Finalization:** Бот меняет владельцев местами (Подарок А уходит второму, Подарок Б первому).

## Поддержка токенов
ИИ должен реализовать проверку транзакций для:
- Native TON.
- Jettons (USDT, Tonnel). *Важно: проверка transaction comment/memo для идентификации платежа.*